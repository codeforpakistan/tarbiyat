{% extends "app/page.html" %}
{% load static %}

{% block title %}Report Detail - {{ report.internship.student.user.get_full_name }}{% endblock %}

{% block content %}
<div class="min-h-screen py-8">
    <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
        <!-- Sidebar -->
        {% include 'app/partials/teacher_sidebar.html' %}

        <!-- Main Content -->
        <div class="lg:col-span-3">
            <!-- Header -->
            <div class="rounded-lg p-6 mb-8 bg-white">
                <div class="flex items-center justify-between">
                    <div>
                        <h1 class="text-3xl font-semibold text-gray-900 mb-2">
                            {{ report.report_month|date:"F Y" }} Report
                        </h1>
                        <p class="text-gray-600">
                            {{ report.internship.student.user.get_full_name }} - 
                            {% if report.internship.mentor.company %}
                                {{ report.internship.mentor.company.name }}
                            {% else %}
                                No Company
                            {% endif %}
                        </p>
                    </div>
                    <div class="text-right">
                        <div class="text-sm text-gray-500">Total Score</div>
                        <div class="text-2xl font-bold 
                            {% if report.get_total_score >= 24 %}text-green-600
                            {% elif report.get_total_score >= 18 %}text-yellow-600
                            {% else %}text-red-600{% endif %}">
                            {{ report.get_total_score }}/30
                        </div>
                    </div>
                </div>
            </div>

            <!-- Student & Internship Info -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                <!-- Student Information -->
                <div class="bg-white rounded-lg p-6 border border-gray-200">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Student Information</h3>
                    <div class="space-y-3">
                        <div>
                            <span class="text-sm text-gray-500">Name:</span>
                            <p class="font-medium">{{ report.internship.student.user.get_full_name }}</p>
                        </div>
                        <div>
                            <span class="text-sm text-gray-500">Student ID:</span>
                            <p class="font-medium">{{ report.internship.student.student_id|default:"Not provided" }}</p>
                        </div>
                        <div>
                            <span class="text-sm text-gray-500">Major:</span>
                            <p class="font-medium">{{ report.internship.student.major|default:"Not specified" }}</p>
                        </div>
                        <div>
                            <span class="text-sm text-gray-500">Year:</span>
                            <p class="font-medium">{{ report.internship.student.get_semester_of_study_display|default:"Not specified" }}</p>
                        </div>
                    </div>
                </div>

                <!-- Report Information -->
                <div class="bg-white rounded-lg p-6 border border-gray-200">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Report Information</h3>
                    <div class="space-y-3">
                        <div>
                            <span class="text-sm text-gray-500">Report Month:</span>
                            <p class="font-medium">{{ report.report_month|date:"F Y" }}</p>
                        </div>
                        <div>
                            <span class="text-sm text-gray-500">Submitted:</span>
                            <p class="font-medium">{{ report.submitted_at|date:"M d, Y g:i A" }}</p>
                        </div>
                        {% if report.updated_at != report.submitted_at %}
                        <div>
                            <span class="text-sm text-gray-500">Last Updated:</span>
                            <p class="font-medium">{{ report.updated_at|date:"M d, Y g:i A" }}</p>
                        </div>
                        {% endif %}
                        <div>
                            <span class="text-sm text-gray-500">Submitted by Teacher:</span>
                            <p class="font-medium">
                                {% if report.teacher %}
                                    {{ report.teacher.user.get_full_name }}
                                {% else %}
                                    Unknown
                                {% endif %}
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Report Content -->
            <div class="space-y-6">
                <!-- Tasks Performed -->
                <div class="bg-white rounded-lg p-6 border border-gray-200">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold text-gray-900">Tasks Performed</h3>
                        <span class="inline-flex px-3 py-1 text-sm font-semibold rounded-full 
                            {% if report.tasks_performed_score >= 8 %}bg-green-100 text-green-800
                            {% elif report.tasks_performed_score >= 6 %}bg-yellow-100 text-yellow-800
                            {% else %}bg-red-100 text-red-800{% endif %}">
                            {{ report.tasks_performed_score }}/10
                        </span>
                    </div>
                    <p class="text-gray-700 leading-relaxed">{{ report.tasks_performed }}</p>
                </div>

                <!-- Learning Experience -->
                <div class="bg-white rounded-lg p-6 border border-gray-200">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold text-gray-900">Learning Experience</h3>
                        <span class="inline-flex px-3 py-1 text-sm font-semibold rounded-full 
                            {% if report.learning_experience_score >= 8 %}bg-green-100 text-green-800
                            {% elif report.learning_experience_score >= 6 %}bg-yellow-100 text-yellow-800
                            {% else %}bg-red-100 text-red-800{% endif %}">
                            {{ report.learning_experience_score }}/10
                        </span>
                    </div>
                    <p class="text-gray-700 leading-relaxed">{{ report.learning_experience }}</p>
                </div>

                <!-- Challenges -->
                <div class="bg-white rounded-lg p-6 border border-gray-200">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold text-gray-900">Challenges & Solutions</h3>
                        <span class="inline-flex px-3 py-1 text-sm font-semibold rounded-full 
                            {% if report.challenges_score >= 8 %}bg-green-100 text-green-800
                            {% elif report.challenges_score >= 6 %}bg-yellow-100 text-yellow-800
                            {% else %}bg-red-100 text-red-800{% endif %}">
                            {{ report.challenges_score }}/10
                        </span>
                    </div>
                    <p class="text-gray-700 leading-relaxed">{{ report.challenges }}</p>
                </div>

                <!-- Additional Comments -->
                {% if report.additional_comments %}
                <div class="bg-white rounded-lg p-6 border border-gray-200">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Additional Comments</h3>
                    <p class="text-gray-700 leading-relaxed">{{ report.additional_comments }}</p>
                </div>
                {% endif %}

                <!-- Score Summary -->
                <div class="bg-white rounded-lg p-6 border border-gray-200">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Score Summary</h3>
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div class="text-center p-4 bg-gray-50 rounded-lg">
                            <div class="text-2xl font-bold text-gray-900">{{ report.tasks_performed_score }}</div>
                            <div class="text-sm text-gray-500">Tasks Performed</div>
                        </div>
                        <div class="text-center p-4 bg-gray-50 rounded-lg">
                            <div class="text-2xl font-bold text-gray-900">{{ report.learning_experience_score }}</div>
                            <div class="text-sm text-gray-500">Learning Experience</div>
                        </div>
                        <div class="text-center p-4 bg-gray-50 rounded-lg">
                            <div class="text-2xl font-bold text-gray-900">{{ report.challenges_score }}</div>
                            <div class="text-sm text-gray-500">Challenges</div>
                        </div>
                        <div class="text-center p-4 bg-blue-50 rounded-lg">
                            <div class="text-2xl font-bold text-blue-600">{{ report.get_total_score }}</div>
                            <div class="text-sm text-gray-500">Total Score</div>
                        </div>
                    </div>
                </div>

                <!-- Actions -->
                <div class="bg-white rounded-lg p-6 border border-gray-200">
                    <div class="flex justify-between items-center">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-900">Actions</h3>
                            <p class="text-gray-600">View related information</p>
                        </div>
                        <div class="flex space-x-4">
                            <a href="{% url 'teacher_internship_detail' report.internship.nanoid %}" 
                               class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition duration-200">
                                View Internship
                            </a>
                            <a href="{% url 'teacher_reports' %}" 
                               class="px-4 py-2 border border-gray-200 text-gray-700 rounded-md hover:bg-gray-50 transition duration-200">
                                Back to Reports
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
